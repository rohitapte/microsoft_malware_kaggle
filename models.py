from sklearn.linear_model import LogisticRegression
from sklearn.metrics import roc_auc_score
from features import generate_features_for_ml_algos

train_x,cv_x,train_labels,cv_labels,test_ids,x_test=generate_features_for_ml_algos()

def run_logistic_regression():
    clf=LogisticRegression()
    clf.fit(train_x,train_labels)
    print("Cross validation score %s"%(clf.score(cv_x,cv_labels)))
    predicted_cv=clf.predict_proba(cv_x)
    print("ROC_AUC score %s"%(roc_auc_score(cv_labels,predicted_cv[:,1])))

    predicted=clf.predict_proba(x_test)
    test_ids['HasDetections']=predicted[:,1]
    test_ids[['MachineIdentifier','HasDetections']].to_csv('logistic_regression_one_hot.csv',index=None)

run_logistic_regression()